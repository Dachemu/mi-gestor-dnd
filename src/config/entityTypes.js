/**
 * Configuraci√≥n central para todos los tipos de entidades del gestor D&D
 * Define esquemas, validaciones, iconos y comportamientos espec√≠ficos
 */

// Esquemas de formulario para cada tipo de entidad
export const ENTITY_SCHEMAS = {
  players: {
    name: { type: 'text', required: true, label: 'Nombre del personaje', placeholder: 'Ej: Aragorn' },
    player: { type: 'text', label: 'Jugador real', placeholder: 'Nombre del jugador' },
    class: { 
      type: 'select', 
      label: 'Clase',
      options: ['B√°rbaro', 'Bardo', 'Brujo', 'Cl√©rigo', 'Druida', 'Explorador', 'Guerrero', 'Hechicero', 'Mago', 'Monje', 'Palad√≠n', 'P√≠caro', 'Artificiero']
    },
    background: { type: 'text', label: 'Trasfondo', placeholder: 'Ej: Noble, Forajido, Ermita√±o...' },
    description: { type: 'textarea', label: 'Descripci√≥n del personaje', placeholder: 'Apariencia, personalidad, historia personal...' },
    backstory: { type: 'richtext', label: 'Historia del personaje', placeholder: 'Historia completa del personaje, conexiones con la trama, motivaciones...' },
    avatar: { type: 'text', label: 'Avatar', defaultValue: '‚öîÔ∏è' },
    icon: { type: 'text', label: 'Icono', defaultValue: '‚öîÔ∏è' }
  },

  quests: {
    title: { type: 'text', required: true, label: 'T√≠tulo de la misi√≥n', placeholder: 'Ej: Recuperar el Amuleto Perdido' },
    description: { type: 'textarea', label: 'Descripci√≥n', placeholder: 'Describe la misi√≥n: objetivos, contexto, lo que deben hacer los jugadores...' },
    status: { 
      type: 'select', 
      label: 'Estado', 
      defaultValue: 'Pendiente',
      options: ['Pendiente', 'En progreso', 'Completada', 'Fallida']
    },
    priority: { 
      type: 'select', 
      label: 'Prioridad', 
      defaultValue: 'Media',
      options: ['Cr√≠tica', 'Alta', 'Media', 'Baja']
    },
    location: { type: 'text', label: 'Ubicaci√≥n', placeholder: '¬øD√≥nde tiene lugar esta misi√≥n?' },
    reward: { type: 'text', label: 'Recompensa', placeholder: 'Ej: 1000 monedas de oro + Espada m√°gica' },
    detailedDescription: { type: 'richtext', label: 'Descripci√≥n detallada', placeholder: 'Informaci√≥n adicional, pistas, secretos, detalles para el DM...' },
    icon: { type: 'text', label: 'Icono', defaultValue: 'üìú' }
  },

  objects: {
    name: { type: 'text', required: true, label: 'Nombre', placeholder: 'Ej: Espada Llameante de Ignis' },
    type: { 
      type: 'select', 
      label: 'Tipo',
      options: ['Arma', 'Armadura', 'Escudo', 'Poci√≥n', 'Pergamino', 'Anillo', 'Amuleto', 'Joya', 'Gema', 'Herramienta', 'Instrumento', 'Libro', 'Mapa', 'Llave', 'Reliquia', 'Artefacto', 'Componente', 'Material', 'Tesoro', 'S√≠mbolo Sagrado', 'Linterna', 'Otro']
    },
    rarity: { 
      type: 'select', 
      label: 'Rareza', 
      defaultValue: 'Com√∫n',
      options: ['Com√∫n', 'Poco com√∫n', 'Raro', '√âpico', 'Legendario']
    },
    description: { type: 'textarea', label: 'Descripci√≥n', placeholder: 'Apariencia, historia, caracter√≠sticas especiales...' },
    detailedDescription: { type: 'richtext', label: 'Descripci√≥n detallada', placeholder: 'Informaci√≥n adicional, historia detallada, propiedades m√°gicas...' },
    owner: { type: 'text', label: 'Propietario', placeholder: '¬øQui√©n lo posee?' },
    location: { type: 'text', label: 'Ubicaci√≥n', placeholder: '¬øD√≥nde se encuentra?' },
    icon: { type: 'text', label: 'Icono', defaultValue: 'üì¶' }
  },

  npcs: {
    name: { type: 'text', required: true, label: 'Nombre', placeholder: 'Ej: Maestro Elrond' },
    role: { type: 'text', label: 'Rol o Profesi√≥n', placeholder: 'Ej: Posadero, Comerciante, Guardia...' },
    description: { type: 'textarea', label: 'Descripci√≥n', placeholder: 'Apariencia f√≠sica, personalidad, trasfondo...' },
    location: { type: 'text', label: 'Ubicaci√≥n habitual', placeholder: '¬øD√≥nde se le puede encontrar normalmente?' },
    attitude: { 
      type: 'select', 
      label: 'Actitud hacia los jugadores', 
      defaultValue: 'Neutral',
      options: ['Amistoso', 'Neutral', 'Hostil', 'Desconfiado', 'Servicial']
    },
    detailedDescription: { type: 'richtext', label: 'Descripci√≥n detallada', placeholder: 'Informaci√≥n adicional, secretos, motivaciones, conexiones con otros personajes...' },
    icon: { type: 'text', label: 'Icono', defaultValue: 'üë§' }
  },

  locations: {
    name: { type: 'text', required: true, label: 'Nombre del lugar', placeholder: 'Ej: Taberna del Drag√≥n Dorado' },
    type: { 
      type: 'select', 
      label: 'Tipo de lugar',
      options: ['Ciudad', 'Pueblo', 'Taberna', 'Castillo', 'Fortaleza', 'Torre', 'Cueva', 'Mazmorra', 'Bosque', 'Monta√±a', 'Templo', 'Universidad', 'Mercado', 'Puerto', 'Ruinas', 'Otro']
    },
    description: { type: 'textarea', label: 'Descripci√≥n', placeholder: 'Describe el lugar: su apariencia, atm√≥sfera, caracter√≠sticas especiales...' },
    importance: { 
      type: 'select', 
      label: 'Importancia en la campa√±a', 
      defaultValue: 'Media',
      options: ['Cr√≠tica', 'Alta', 'Media', 'Baja']
    },
    inhabitants: { type: 'text', label: 'Habitantes', placeholder: '¬øQui√©n vive o frecuenta este lugar?' },
    detailedDescription: { type: 'richtext', label: 'Descripci√≥n detallada', placeholder: 'Informaci√≥n adicional, secretos, detalles espec√≠ficos para el DM...' },
    icon: { type: 'text', label: 'Icono', defaultValue: 'üèõÔ∏è' }
  },

  notes: {
    title: { type: 'text', required: true, label: 'T√≠tulo', placeholder: 'Ej: Notas de la Sesi√≥n 5' },
    category: { 
      type: 'select', 
      label: 'Categor√≠a', 
      defaultValue: 'General',
      options: ['General', 'Sesi√≥n', 'Trama', 'Personajes', 'Mundo', 'Reglas']
    },
    content: { type: 'richtext', label: 'Contenido', placeholder: 'Escribe el contenido de tu nota aqu√≠...', minHeight: '300px' },
    modifiedAt: { type: 'datetime', label: 'Fecha de modificaci√≥n', readOnly: true }
  }
}

// Configuraci√≥n principal de cada tipo de entidad
export const ENTITY_CONFIGS = {
  players: {
    key: 'players',
    name: 'Jugador',
    pluralName: 'Jugadores',
    icon: 'üë•',
    emptyIcon: 'üë•',
    emptyMessage: 'No hay jugadores a√∫n. ¬°A√±ade el primer h√©roe de tu campa√±a!',
    description: 'Los h√©roes de tu campa√±a',
    schema: ENTITY_SCHEMAS.players,
    displayFields: {
      primary: 'name',
      secondary: ['class'],
      description: 'description'
    },
    detailSections: [
      {
        title: 'Informaci√≥n b√°sica',
        fields: ['player', 'class', 'background', 'description']
      },
      {
        title: 'Historia del personaje',
        fields: ['backstory'],
        render: 'html'
      }
    ],
    colors: {}
  },

  quests: {
    key: 'quests',
    name: 'Misi√≥n',
    pluralName: 'Misiones',
    icon: 'üìú',
    emptyIcon: 'üìú',
    emptyMessage: 'No hay misiones a√∫n. ¬°Crea la primera aventura de tu campa√±a!',
    description: 'Las aventuras y objetivos',
    schema: ENTITY_SCHEMAS.quests,
    displayFields: {
      primary: 'title',
      secondary: ['status', 'priority'],
      description: 'description'
    },
    detailSections: [
      {
        title: 'Informaci√≥n b√°sica',
        fields: ['description', 'location', 'reward']
      },
      {
        title: 'Descripci√≥n detallada',
        fields: ['detailedDescription'],
        render: 'html'
      }
    ],
    colors: {
      status: {
        'Completada': '#10b981',
        'En progreso': '#f59e0b',
        'Pendiente': '#6b7280',
        'Fallida': '#ef4444'
      },
      priority: {
        'Cr√≠tica': '#ff0000',
        'Alta': '#ef4444',
        'Media': '#f59e0b',
        'Baja': '#10b981'
      }
    }
  },

  objects: {
    key: 'objects',
    name: 'Objeto',
    pluralName: 'Objetos',
    icon: 'üì¶',
    emptyIcon: 'üì¶',
    emptyMessage: 'No hay objetos a√∫n. ¬°A√±ade el primer tesoro de tu campa√±a!',
    description: 'Los tesoros y artefactos',
    schema: ENTITY_SCHEMAS.objects,
    displayFields: {
      primary: 'name',
      secondary: ['type', 'rarity'],
      description: 'description'
    },
    detailSections: [
      {
        title: 'Informaci√≥n b√°sica',
        fields: ['description', 'owner', 'location']
      },
      {
        title: 'Descripci√≥n detallada',
        fields: ['detailedDescription'],
        render: 'html'
      }
    ],
    colors: {
      rarity: {
        'Legendario': '#ff6b35',
        '√âpico': '#8b5cf6',
        'Raro': '#3b82f6',
        'Poco com√∫n': '#10b981',
        'Com√∫n': '#6b7280'
      }
    }
  },

  npcs: {
    key: 'npcs',
    name: 'NPC',
    pluralName: 'NPCs',
    icon: 'üßô',
    emptyIcon: 'üßô',
    emptyMessage: 'No hay NPCs a√∫n. ¬°A√±ade el primer personaje de tu campa√±a!',
    description: 'Los personajes que dan vida al mundo',
    schema: ENTITY_SCHEMAS.npcs,
    displayFields: {
      primary: 'name',
      secondary: ['role'],
      description: 'description'
    },
    detailSections: [
      {
        title: 'Informaci√≥n b√°sica',
        fields: ['description', 'location', 'attitude']
      },
      {
        title: 'Descripci√≥n detallada',
        fields: ['detailedDescription'],
        render: 'html'
      }
    ],
    colors: {
      attitude: {
        'Amistoso': '#10b981',
        'Hostil': '#ef4444',
        'Neutral': '#8b5cf6'
      }
    }
  },

  locations: {
    key: 'locations',
    name: 'Lugar',
    pluralName: 'Lugares',
    icon: 'üìç',
    emptyIcon: 'üìç',
    emptyMessage: 'No hay lugares a√∫n. ¬°A√±ade el primer escenario de tu campa√±a!',
    description: 'Los escenarios donde transcurren las aventuras',
    schema: ENTITY_SCHEMAS.locations,
    displayFields: {
      primary: 'name',
      secondary: ['type', 'importance'],
      description: 'description'
    },
    detailSections: [
      {
        title: 'Informaci√≥n b√°sica',
        fields: ['description', 'type', 'inhabitants']
      },
      {
        title: 'Descripci√≥n detallada',
        fields: ['detailedDescription'],
        render: 'html'
      }
    ],
    colors: {
      importance: {
        'Cr√≠tica': '#ff0000',
        'Alta': '#ef4444',
        'Media': '#f59e0b',
        'Baja': '#10b981'
      }
    }
  },

  notes: {
    key: 'notes',
    name: 'Nota',
    pluralName: 'Notas',
    icon: 'üìù',
    emptyIcon: 'üìù',
    emptyMessage: 'No hay notas a√∫n. ¬°A√±ade la primera nota de tu campa√±a!',
    description: 'Tus apuntes y recordatorios',
    schema: ENTITY_SCHEMAS.notes,
    displayFields: {
      primary: 'title',
      secondary: ['category'],
      description: 'content'
    },
    detailSections: [
      {
        title: 'Contenido',
        fields: ['content'],
        render: 'html'
      }
    ],
    colors: {
      category: {
        'General': '#6b7280',
        'Sesi√≥n': '#3b82f6',
        'Trama': '#8b5cf6',
        'Personajes': '#10b981',
        'Mundo': '#f59e0b',
        'Reglas': '#ef4444'
      }
    },
    filters: ['category'],
    fixedIcon: 'üìù'
  }
}

// Funci√≥n helper para obtener la configuraci√≥n de un tipo de entidad
export function getEntityConfig(entityType) {
  return ENTITY_CONFIGS[entityType] || null
}

// Funci√≥n helper para obtener todos los tipos de entidad disponibles
export function getAllEntityTypes() {
  return Object.keys(ENTITY_CONFIGS)
}

// Funci√≥n helper para validar un item seg√∫n su esquema
export function validateEntity(entityType, data) {
  const config = getEntityConfig(entityType)
  if (!config) return { isValid: false, errors: ['Tipo de entidad no v√°lido'] }

  const errors = {}
  
  Object.entries(config.schema).forEach(([fieldName, fieldConfig]) => {
    if (fieldConfig.required && (!data[fieldName] || !data[fieldName].toString().trim())) {
      errors[fieldName] = `${fieldConfig.label} es obligatorio`
    }
  })

  return {
    isValid: Object.keys(errors).length === 0,
    errors
  }
}

export default ENTITY_CONFIGS